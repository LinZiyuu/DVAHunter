
_cdn_cname_mappings = {
    ".akamai.net.": "Akamai", 
    ".akamaiedge.net.": "Akamai",
    ".edgesuite.net.": "Akamai",
    ".akamai-staging.net.": "Akamai", 
    ".akamai.com.": "Akamai",
    ".akamaitech.net.": "Akamai",
    ".edgekey.net.": "Akamai",
    ".srip.ne.": "Akamai",
    ".akamaitechnologies.fr": "Akamai",
    ".cdngslb.com.": "Alibaba Cloud", 
    ".alibaba.com.": "Alibaba Cloud", 
    ".alicdn.com.": "Alibaba Cloud", 
    ".alikunlun.com.": "Alibaba Cloud",  
    ".kunlunsl.com.": "Alibaba Cloud",  
    ".kunlunca.com.": "Alibaba Cloud",  
    ".kunlunaq.com.": "Alibaba Cloud",  
    ".kunlungr.com.": "Alibaba Cloud",  
    ".kunlunar.com.": "Alibaba Cloud",  
    ".kunluncan.com.": "Alibaba Cloud",  
    ".kunlunso.com.": "Alibaba Cloud",  
    ".kunlunpi.com.": "Alibaba Cloud",  
    ".kunlunea.com.": "Alibaba Cloud",  
    ".kunlunhuf.com.": "Alibaba Cloud",  
    ".kunlunle.com.": "Alibaba Cloud",  
    ".alikunlun.net.": "Alibaba Cloud",  
    ".danuoyi.tbcache.com ": "Alibaba Cloud", 
    ".alicloudlayer.com.": "Alibaba Cloud", 
    ".alicloudsec.com.": "Alibaba Cloud",
    ".alivecdn.com.": "Alibaba Cloud", 
    ".aliyun-inc.com.": "Alibaba Cloud", 
    ".gslb.tbcache.com.": "Alibaba Cloud", 
    ".gslb.taobao.com.": "Alibaba Cloud", 
    ".tbcdn.cn.": "Alibaba Cloud", 
    ".taobaocdn.com.": "Alibaba Cloud", 

    ".arvancdn.com":"ArvanCloud",
    ".arvancdn.ir.":"ArvanCloud",

    ".map.azionedge.net.": "Azion", 
    ".azioncdn.net.": "Azion", 
    ".azioncdn.com.": "Azion", 
    ".azion.net.": "Azion", 


    ".azureedge.net.": "Azure",  
    ".azurefd.net.": "Azure",  
    ".azure.net.": "Azure",  
    ".vo.msecnd.net.": "Azure", 

    ".bdydns.com.":"BaiDuCloud",
    "jomodns.com.": "BaiDuCloud", 
    ".yunjiasu-cdn.net.":"BaiDuCloud", 
    ".yjs-cdn.com.":"BaiDuCloud", 
    ".bdydns.cn.":"BaiDuCloud", 
    ".bdydns.net.":"BaiDuCloud", 
    ".baiduyundns.cn.":"BaiDuCloud", 
    ".baiduyundns.com.":"BaiDuCloud", 
    ".baiduyundns.net.":"BaiDuCloud", 
    ".bcedns.cn.":"BaiDuCloud", 
    ".bcedns.com.":"BaiDuCloud", 
    ".bcedns.net.":"BaiDuCloud", 

    ".belugacdn.com.": "BelugaCDN",
    ".custompcguide.net.": "BelugaCDN",
    ".nucdn.net.": "BelugaCDN",

    ".b-cdn.net.": "Bunny", 
    ".b-cdn.com.": "Bunny", 
    ".bunnycdn.com. ": "Bunny", 
    ".bunny.net. ": "Bunny", 

    
    ".rsc.cdn77.org.": "CDN77",
    ".cdn77.net.": "CDN77",  
    ".c.cdn77.org": "CDN77", 
    ".cdn77-ssl.net": "CDN77", 
    ".r.cdn77.net": "CDN77", 
    "ssl.origin.cdn77-secure.org": "CDN77", 

    ".cdnsun.net.":"CDNsun",


    ".cdngc.net.": "CDNetworks", 
    ".gccdn.net.": "CDNetworks", 
    ".qtlgslb.com.": "CDNetworks", 
    ".panthercdn.com.": "CDNetworks", 
    ".cdnetworks.net.": "CDNetworks",  
    ".gccdn.cn.": "CDNetworks", 


    ".trbcdn.net.":"CDNvideo", 
    ".cdnvideo.ru.":"CDNvideo",

    ".cachefly.net.": "Cachefly", 
    ".c3cache.net.": "Cachefly", 
    ".c3cdn.net.": "Cachefly", 
    ".cachecn.com.": "Cachefly", 

    ".cloudflare.com.": "Cloudflare", 
    ".cdn.cloudflare.net.": "Cloudflare", 

    ".cloudfront.net.": "Cloudfront", 
    ".awsdns.": "Cloudfront", 

    ".bsclink.cn." : "EdgeNext", 
    ".ccgslb.com.cn.":"EdgeNext", 
    ".ccgslb.com.": "EdgeNext", 
    ".ccgslb.net.": "EdgeNext",
    ".chinacache.net.": "EdgeNext", 
    ".cncssr.chinacache.net.": "EdgeNext", 

    ".glb.edgio.net.": "Edgio", 
    ".systemcdn.net.": "Edgio", 
    ".edgecastcdn.net.": "Edgio", 
    ".adn.": "Edgio", 
    ".wac.": "Edgio", 
    ".wpc.": "Edgio", 
    ".edgio.net.": "Edgio", 
    ".transactcdn.net.": "Edgio", 
    ".v1cdn.net.": "Edgio", 
    ".v2cdn.net.": "Edgio", 
    ".v3cdn.net.": "Edgio", 
    ".v4cdn.net.": "Edgio", 
    ".v5cdn.net.": "Edgio", 

    ".fastly.net.": "Fastly", 
    ".fastlylb.net.": "Fastly",
    ".nocookie.net.": "Fastly", 
    "edgecompute.app": "Fastly", 
    "fastly-edge.com": "Fastly", 
    "fastly-terrarium.com": "Fastly", 
    ".xcdn.global.": "Udomain",
    ".s2-web.dogedns.com.": "Dogecloud",
    ".yuncdn.layuncdn.com.": "Layun",
    ".sudun1.suduncdn.com.": "Sudun",

    "d.gcdn.co": "G-core",

    ".cdnhwc1.com.":"HuaweiCloud",
    ".cdnhwc2.com.":"HuaweiCloud",
    ".cdnhwcxcy07.com.":"HuaweiCloud",

    ".cloud-scdn.com.":"JDCloud",
    ".jcloud-cdn.com.":"JDCloud",

    ".kxcdn.com.": "KeyCDN",
    ".kvcdn.com.": "KeyCDN",

    ".ksyuncdn.com.": "KingsoftCloud",
    ".ks-cdn.com.": "KingsoftCloud",

    ".lswcdn.net.": "LeaseWeb",
    ".llnwd.net": "Limelight",
    ".lldns.net": "Limelight",
    ".footprint.net.": "Lumen",
    ".fpbns.net.": "Lumen",

    ".mncdn.com.": "Medianova", 
    ".mncdn.org.": "Medianova", 

    ".netlify.com.":"Netlify", 
    ".netlifyglobalcdn.com.":"Netlify", 
    ".netlify.app.":"Netlify", 

    ".qiniudns.com.":"Qiniu",

    ".hwcdn.net.": "StackPath",
    ".stackpathcdn.com.": "StackPath",
    ".stackpathdns.com": "StackPath",


    ".cdn.dnsv1.com.":"TencentCloud", 
    ".tdnsv6.com.":"TencentCloud", 
    ".cdntip.com.":"TencentCloud", 
    ".tdnsv8.com.":"TencentCloud", 
    ".cdn300.cn.":"TencentCloud", 
    ".cdn-st.site.cn.":"TencentCloud", 

    ".ucloud.com.cn.":"UCloud",

    ".aicdn.com.":"UPYun", 
    ".hcnamecdns.com.":"UPYun", 

    ".lxdns.com.": "ChinaNetCenter", 
    ".cdn20.com.": "ChinaNetCenter", 
    ".cdn30.com.": "ChinaNetCenter", 
    ".wscdns.com.": "ChinaNetCenter", 
    ".wswebcdn.com.": "ChinaNetCenter", 
    ".wtxcdn.com.": "ChinaNetCenter",  

    ".51cdn.com.": "ChinaNetCenter", 



    ".r.cdn36.com": "LightCDN",
    ".prod.defense-dns.net": "Goooood",
    ".kuocaidns.com.": "KuoCai",
    "agilewingcdn.com.":"AgileCDN",
    ".bsclink.cn.":"EdgeNext",
    ".trpcdn.net.":"EdgeNext",
    ".yunduncdns.com.":"Yundun",
    ".cname.hcnamedns.com.":"Yundun",
    "cdn.jiashule.com.": "Yunaq"
}

_cdn_ns_mappings = {
    ".akam.net.":"Akamai",
    ".akamaitechnologies.com.":"Akamai",
    ".azure-dns.com.":"Azure",
    ".azure-dns.net.":"Azure",
    ".azure-dns.inf.":"Azure",
    ".azure-dns.org.":"Azure",
    ".ns.arvancdn.com.":"ArvanCloud",
    ".ns.arvancdn.ir.":"ArvanCloud",
    ".belugacdn.com":"BelugaCDN",
    ".b-cdn.com":"Bunny",
    ".bunnydns.com.":"Bunny",
    ".bunny.net.":"Bunny",
    ".cachenetworks.com.":"CacheFly",
    ".cdn77.com.":"CDN77",
    ".cdnetdns.net.":"CDNetworks",
    ".cdnvideo.ru.":"CDNvideo",
    ".cloudflare.com.":"Cloudflare",
    ".amazonaws.com.":"Cloudfront",
    ".cloudfront.net":"Cloudfront",
    ".chinanetcenter.com.":"ChinaNetCenter",
    ".fastly.net.":"Fastly",
    ".gcorelabs.net.":"G-core",
    ".gcdn.services.":"G-core",
    ".1e100.net.":"Google",
    ".googleusercontent.com.":"Google",
    ".kscdns.com.":"KingsoftCloud",
    ".proinity.net.":"KeyCDN",
    ".Leaseweb.nl.":"LeaseWeb",
    ".Leaseweb.net.":"LeaseWeb",
    ".stackpathdns.net.":"StackPath",
    ".hwcdn.net":"StackPath",
}

def cname_mapping(cname):
    for k, v in _cdn_cname_mappings.items():
        if k in cname:
            return v
        

def ns_mapping(ns):
    for k, v in _cdn_ns_mappings.items():
        if k in ns:
            return v
        
def check_CNAME(cname_list):
    if cname_list:
        for cname in cname_list:
            cdn_provider = cname_mapping(cname)
            if cdn_provider:
                return cdn_provider
    return "None"

def check_NS(ns_list):
    if ns_list:
        for ns in ns_list:
            cdn_provider = ns_mapping(ns)
            if cdn_provider:
                return cdn_provider
    return "None"